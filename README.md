# ğŸš€ KokkoSofter

ãƒ¢ãƒ€ãƒ³ã§ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒãƒ¼ãƒ å‘ã‘ã‚½ãƒ¼ã‚·ãƒ£ãƒ«æŠ•ç¨¿ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

![Django](https://img.shields.io/badge/Django-5.2.4-green)
![Python](https://img.shields.io/badge/Python-3.8+-blue)
![License](https://img.shields.io/badge/License-MIT-yellow)

## âœ¨ ç‰¹å¾´

- ğŸ¨ **DaisyUI + Tailwind CSS** ã«ã‚ˆã‚‹ç¾ã—ã„UI
- ğŸ“± **å®Œå…¨ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–** ãƒ‡ã‚¶ã‚¤ãƒ³
- ğŸŒ™ **ãƒ€ãƒ¼ã‚¯/ãƒ©ã‚¤ãƒˆãƒ†ãƒ¼ãƒ** åˆ‡ã‚Šæ›¿ãˆ
- ğŸ’« **ã‚¹ãƒ ãƒ¼ã‚ºãªãƒšãƒ¼ã‚¸é·ç§»** ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- ğŸ–¼ï¸ **ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰** æ©Ÿèƒ½
- ğŸ‘¥ **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ** ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹è¡¨ç¤º
- ğŸŒ¤ï¸ **å¤©æ°—æƒ…å ±** ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
- ğŸ• **ãƒ‡ã‚¸ã‚¿ãƒ«æ™‚è¨ˆ** ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
- ğŸ”’ **ã‚»ã‚­ãƒ¥ã‚¢** ãªèªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- ğŸ‘‘ **ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»æŠ•ç¨¿ç®¡ç†
- ğŸ—‘ï¸ **æŠ•ç¨¿å‰Šé™¤æ©Ÿèƒ½** - æ¨©é™ã«å¿œã˜ãŸå‰Šé™¤åˆ¶å¾¡
- âš™ï¸ **æ¨©é™ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ** - ã‚¹ã‚¿ãƒƒãƒ•ãƒ»ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹åˆ‡ã‚Šæ›¿ãˆ

## ğŸ® ä¸»ãªæ©Ÿèƒ½

### ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ©Ÿèƒ½
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³**: ã‚»ã‚­ãƒ¥ã‚¢ãªèªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç†**: ã‚¢ãƒã‚¿ãƒ¼ç”»åƒãƒ»è‡ªå·±ç´¹ä»‹ã®è¨­å®š
- **æŠ•ç¨¿ä½œæˆ**: ãƒ†ã‚­ã‚¹ãƒˆãƒ»ç”»åƒæŠ•ç¨¿
- **ã„ã„ã­æ©Ÿèƒ½**: æŠ•ç¨¿ã¸ã®åå¿œ
- **æŠ•ç¨¿å‰Šé™¤**: è‡ªåˆ†ã®æŠ•ç¨¿ã®ã¿å‰Šé™¤å¯èƒ½

### ğŸ‘‘ ç®¡ç†è€…æ©Ÿèƒ½
- **ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆãƒ»æ¦‚è¦è¡¨ç¤º
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†**: 
  - æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆæ¨©é™è¨­å®šå«ã‚€ï¼‰
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ç·¨é›†
  - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–/éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åˆ‡ã‚Šæ›¿ãˆ
  - ã‚¹ã‚¿ãƒƒãƒ•æ¨©é™ã®ä»˜ä¸ãƒ»å‰Šé™¤
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ï¼ˆå®‰å…¨ãªå‰Šé™¤åˆ¶å¾¡ï¼‰
- **æŠ•ç¨¿ç®¡ç†**:
  - å…¨æŠ•ç¨¿ã®ä¸€è¦§ãƒ»è©³ç´°è¡¨ç¤º
  - ä¸é©åˆ‡æŠ•ç¨¿ã®å‰Šé™¤
  - æŠ•ç¨¿çµ±è¨ˆã®ç¢ºèª
- **ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†**: Djangoç®¡ç†ç”»é¢ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

## ğŸ¯ æœ¬ç•ªç’°å¢ƒé‹ç”¨ï¼ˆæ¨å¥¨ï¼‰

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æœ¬ç•ªç’°å¢ƒã§ã®å®‰å…¨ãªé‹ç”¨ã‚’é‡è¦–ã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

### ğŸ“‹ å‰ææ¡ä»¶

- **OS**: Ubuntu 20.04 LTS / 22.04 LTS æ¨å¥¨
- **Python**: 3.8ä»¥ä¸Š
- **Web Server**: Nginx + Gunicorn
- **Process Manager**: systemd

## ğŸš€ æœ¬ç•ªç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå®Œå…¨è‡ªå‹•åŒ–ï¼‰

### 1. ã‚µãƒ¼ãƒãƒ¼æº–å‚™

```bash
# ã‚·ã‚¹ãƒ†ãƒ ã®æ›´æ–°ã¨å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt update && sudo apt upgrade -y
sudo apt install python3 python3-venv python3-pip nginx git -y
```

### 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
sudo mkdir -p /var/www/kokkosofter
sudo chown $USER:$USER /var/www/kokkosofter

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
cd /var/www/kokkosofter
git clone https://github.com/hatane-rgb/KokkoSofter.git .
```

### 3. è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ

```bash
# ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
chmod +x deploy.sh

# æœ¬ç•ªç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå®Œå…¨è‡ªå‹•åŒ–ï¼‰
./deploy.sh production
```

**ã“ã®ã‚³ãƒãƒ³ãƒ‰ä¸€ç™ºã§ä»¥ä¸‹ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™:**
- Pythonä»®æƒ³ç’°å¢ƒã®æ§‹ç¯‰
- ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ç”Ÿæˆã¨SECRET_KEYè¨­å®š
- **ãƒ‰ãƒ¡ã‚¤ãƒ³/IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å¯¾è©±å¼è¨­å®š**
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åé›†
- systemdã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²ãƒ»èµ·å‹•
- Nginxè¨­å®šã®é©ç”¨

### 4. èµ·å‹•ç¢ºèª

```bash
# ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ã®ç¢ºèª
make service-status
make nginx-status

# ãƒ­ã‚°ã®ç¢ºèª
make service-logs
```

## ğŸ› ï¸ é‹ç”¨ã‚³ãƒãƒ³ãƒ‰ï¼ˆMakefileï¼‰

æœ¬ç•ªç’°å¢ƒã§ã®æ—¥å¸¸é‹ç”¨ã«ä¾¿åˆ©ãªã‚³ãƒãƒ³ãƒ‰ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ï¼š

### ğŸ“‹ ãƒ˜ãƒ«ãƒ—ãƒ»çŠ¶æ…‹ç¢ºèª
```bash
make help                # åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ä¸€è¦§è¡¨ç¤º
make service-status      # systemdã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
make service-logs        # systemdã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚°è¡¨ç¤º
make nginx-status        # NginxçŠ¶æ…‹ç¢ºèª
make check-csrf          # CSRFé–¢é€£è¨­å®šç¢ºèª
```

### ğŸš€ ã‚µãƒ¼ãƒ“ã‚¹ç®¡ç†
```bash
make service-restart     # systemdã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
make nginx-setup         # Nginxè¨­å®šã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make nginx-test          # Nginxè¨­å®šãƒ†ã‚¹ãƒˆ
make nginx-disable-default # Nginxãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚µã‚¤ãƒˆç„¡åŠ¹åŒ–
```

### ğŸŒ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š
```bash
make configure-domain    # ãƒ‰ãƒ¡ã‚¤ãƒ³/IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¯¾è©±å¼ã§è¨­å®š
make quick-domain-setup  # ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šâ†’Nginxé©ç”¨â†’å†èµ·å‹•ã‚’ä¸€æ‹¬å®Ÿè¡Œ
make fix-csrf           # CSRFæ¤œè¨¼ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ï¼ˆå¯¾è©±å¼ï¼‰
```

### ğŸ”§ é–‹ç™ºãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
```bash
make dev-setup          # é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make run                # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
make migrate            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
make static             # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åé›†
make superuser          # ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
make shell              # Django shellèµ·å‹•
```

### ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»æ¨©é™
```bash
make generate-secret-key # Djangoç”¨SECRET_KEYç”Ÿæˆ
make fix-permissions    # ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿®æ­£
make create-dirs        # å¿…è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
make test-django        # Djangoè¨­å®šãƒ†ã‚¹ãƒˆï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯å«ã‚€ï¼‰
```

### ğŸ› ãƒ‡ãƒãƒƒã‚°ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
```bash
make debug-enable       # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹åŒ–ï¼ˆä¸€æ™‚çš„ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ï¼‰
make debug-disable      # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ç„¡åŠ¹åŒ–
make debug-gunicorn     # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§Gunicornèµ·å‹•
make check              # Djangoã‚·ã‚¹ãƒ†ãƒ ãƒã‚§ãƒƒã‚¯
```

### ğŸ§¹ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
make clean              # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
make backup-db          # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
make requirements       # requirements.txtæ›´æ–°
make test               # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
make fix-media          # ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿®æ­£
make check-media        # ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®šç¢ºèª
```

### ğŸ“¦ åˆæœŸåŒ–ãƒ»Gitç®¡ç†
```bash
make install            # ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
make git-init           # Gitãƒªãƒã‚¸ãƒˆãƒªåˆæœŸåŒ–
make fix-git-owner      # Gitæ‰€æœ‰è€…å•é¡Œä¿®æ­£
make git-pull           # æœ€æ–°ã‚³ãƒ¼ãƒ‰å–å¾—
make start              # ç°¡å˜é–‹ç™ºé–‹å§‹ï¼ˆç’°å¢ƒæ§‹ç¯‰+ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼‰
```

### ğŸ‘‘ ç®¡ç†è€…å‘ã‘æ©Ÿèƒ½

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†:**
- ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰: `/accounts/admin-dashboard/`
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§: `/accounts/admin-users/`
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ: `/accounts/admin-create-user/`
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†: `/accounts/admin-edit-user/<user_id>/`

**æŠ•ç¨¿ç®¡ç†:**
- æŠ•ç¨¿ç®¡ç†ç”»é¢: `/posts/admin-posts/`
- æŠ•ç¨¿å‰Šé™¤: Ajaxå¯¾å¿œã®ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«

**æ¨©é™åˆ¶å¾¡:**
- ç®¡ç†è€…: å…¨æŠ•ç¨¿å‰Šé™¤ãƒ»å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†å¯èƒ½
- ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼: è‡ªåˆ†ã®æŠ•ç¨¿ã®ã¿å‰Šé™¤å¯èƒ½
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–/éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åˆ‡ã‚Šæ›¿ãˆ
- ã‚¹ã‚¿ãƒƒãƒ•æ¨©é™ã®ä»˜ä¸ãƒ»å‰Šé™¤

### ğŸ’¡ ã‚ˆãä½¿ç”¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰çµ„ã¿åˆã‚ã›

**CSRF/ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼è§£æ±º:**
```bash
make fix-csrf           # å¯¾è©±å¼ã§ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š
make check-csrf         # è¨­å®šç¢ºèª
make service-restart    # åæ˜ 
```

**æ–°ã—ã„ãƒ‰ãƒ¡ã‚¤ãƒ³è¿½åŠ :**
```bash
make quick-domain-setup # å…¨è‡ªå‹•ï¼ˆæ¨å¥¨ï¼‰
# ã¾ãŸã¯
make configure-domain && make nginx-setup && make service-restart
```

**å•é¡Œç™ºç”Ÿæ™‚ã®ç¢ºèª:**
```bash
make service-logs       # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
make nginx-test         # Nginxè¨­å®šç¢ºèª
make test-django        # Djangoè¨­å®šç¢ºèª
```

**æ¨©é™ã‚¨ãƒ©ãƒ¼è§£æ±º:**
```bash
make fix-permissions    # ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿®æ­£
make create-dirs        # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†ä½œæˆ
make service-restart    # ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
```

**Gitæ›´æ–°ã‚¨ãƒ©ãƒ¼è§£æ±º:**
```bash
# å®‰å…¨ãªæ›´æ–°æ‰‹é †
git stash               # ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ä¸€æ™‚ä¿å­˜
git pull origin main    # æœ€æ–°ã‚³ãƒ¼ãƒ‰å–å¾—
make migrate            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°
make static             # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°
make service-restart    # ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•

# ã¾ãŸã¯å¼·åˆ¶æ›´æ–°ï¼ˆæ³¨æ„: ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ãŒå‰Šé™¤ã•ã‚Œã‚‹ï¼‰
git reset --hard HEAD && git clean -fd && git pull origin main
make migrate && make static && make service-restart
```

**ç·Šæ€¥æ™‚ã®å®Œå…¨å¾©æ—§:**
```bash
# ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒªã‚»ãƒƒãƒˆã¨æ›´æ–°
make fix-permissions && make fix-media && make nginx-setup
make migrate && make static && make service-restart
```

## âš™ï¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### ç’°å¢ƒå¤‰æ•°ï¼ˆ.envï¼‰

æœ¬ç•ªç’°å¢ƒã§ã¯ä»¥ä¸‹ã®è¨­å®šãŒé‡è¦ã§ã™ï¼š

```bash
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
SECRET_KEY=è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™
DEBUG=False

# ãƒ›ã‚¹ãƒˆè¨­å®š
ALLOWED_HOSTS=localhost,127.0.0.1,192.168.x.x,your-domain.com

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSQLiteä½¿ç”¨ã€PostgreSQLã‚‚å¯¾å¿œï¼‰
DATABASE_URL=sqlite:///db.sqlite3

# HTTPSè¨­å®šï¼ˆSSLè¨¼æ˜æ›¸å–å¾—å‰ã¯ç„¡åŠ¹ï¼‰
SECURE_SSL_REDIRECT=False
SESSION_COOKIE_SECURE=False
CSRF_COOKIE_SECURE=False
```

**é‡è¦**: `deploy.sh`å®Ÿè¡Œæ™‚ã«`SECRET_KEY`ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### ALLOWED_HOSTSè¨­å®šï¼ˆè‡ªå‹•åŒ–å¯¾å¿œï¼‰

**æ¨å¥¨æ–¹æ³•ï¼ˆå¯¾è©±å¼è¨­å®šï¼‰:**
```bash
# ãƒ‰ãƒ¡ã‚¤ãƒ³/IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¯¾è©±å¼ã§è¨­å®š
make configure-domain

# ã¾ãŸã¯ä¸€æ‹¬è¨­å®šï¼ˆè¨­å®šâ†’é©ç”¨â†’å†èµ·å‹•ï¼‰
make quick-domain-setup
```

**æ‰‹å‹•è¨­å®š:**
ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ›ã‚¹ãƒˆã‚’.envãƒ•ã‚¡ã‚¤ãƒ«ã§æ‰‹å‹•è¨­å®šï¼š

```bash
# ä¾‹: IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³å
ALLOWED_HOSTS=192.168.1.8,er.kokkosoft.com,www.er.kokkosoft.com

# æ³¨æ„: ãƒãƒ¼ãƒˆç•ªå·ã¯å«ã‚ãªã„ï¼ˆæ­£ã—ã„ï¼‰
ALLOWED_HOSTS=192.168.1.8

# é–“é•ã„: ãƒãƒ¼ãƒˆç•ªå·ã‚’å«ã‚€
ALLOWED_HOSTS=192.168.1.8:8000  # ã“ã‚Œã¯é–“é•ã„
```

## ğŸ” SSL/HTTPSè¨­å®š

### HTTPé‹ç”¨ï¼ˆåˆæœŸè¨­å®šï¼‰

ç¾åœ¨ã®è¨­å®šã¯HTTPé‹ç”¨ç”¨ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™ï¼š

- **HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¯ç„¡åŠ¹** ï¼ˆ`SECURE_SSL_REDIRECT=False`ï¼‰
- **Nginxè¨­å®šã§HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ**
- **IPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’å„ªå…ˆ**

### HTTPSå¯¾å¿œã®æ‰‹é †

SSLè¨¼æ˜æ›¸ã‚’å–å¾—ã—ã¦HTTPSé‹ç”¨ã«ç§»è¡Œã™ã‚‹å ´åˆï¼š

#### 1. SSLè¨¼æ˜æ›¸ã®å–å¾—ï¼ˆLet's Encryptæ¨å¥¨ï¼‰

```bash
# Certbotã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt install certbot python3-certbot-nginx -y

# SSLè¨¼æ˜æ›¸ã®å–å¾—ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³åãŒå¿…è¦ï¼‰
sudo certbot --nginx -d er.kokkosoft.com -d www.er.kokkosoft.com
```

#### 2. Djangoè¨­å®šã§HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’æœ‰åŠ¹åŒ–

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã§HTTPSè¨­å®šã‚’æœ‰åŠ¹åŒ–
echo "SECURE_SSL_REDIRECT=True" >> /var/www/kokkosofter/.env
echo "SESSION_COOKIE_SECURE=True" >> /var/www/kokkosofter/.env
echo "CSRF_COOKIE_SECURE=True" >> /var/www/kokkosofter/.env

# HSTSã®æœ‰åŠ¹åŒ–ï¼ˆæ¨å¥¨ï¼‰
echo "SECURE_HSTS_SECONDS=31536000" >> /var/www/kokkosofter/.env
echo "SECURE_HSTS_INCLUDE_SUBDOMAINS=True" >> /var/www/kokkosofter/.env
echo "SECURE_HSTS_PRELOAD=True" >> /var/www/kokkosofter/.env
```

#### 3. Nginxè¨­å®šã§HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’æœ‰åŠ¹åŒ–

```bash
# nginx_kokkosofter.confã®HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’æœ‰åŠ¹åŒ–
sudo nano /etc/nginx/sites-available/kokkosofter

# ä»¥ä¸‹ã®è¡Œã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã™:
# return 301 https://$server_name$request_uri;

# Nginxè¨­å®šã‚’ãƒªãƒ­ãƒ¼ãƒ‰
sudo nginx -t
sudo systemctl reload nginx
```

#### 4. Django ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•

```bash
make service-restart
```

### HTTPSè»¢é€ã®åˆ¶å¾¡

**ç„¡åŠ¹åŒ–ï¼ˆHTTPé‹ç”¨ï¼‰:**
```bash
# Djangoå´ï¼ˆ.envï¼‰
SECURE_SSL_REDIRECT=False

# Nginxå´ï¼ˆnginx_kokkosofter.confï¼‰
# return 301 https://$server_name$request_uri;  # ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
```

**æœ‰åŠ¹åŒ–ï¼ˆHTTPSé‹ç”¨ï¼‰:**
```bash
# Djangoå´ï¼ˆ.envï¼‰
SECURE_SSL_REDIRECT=True

# Nginxå´ï¼ˆnginx_kokkosofter.confï¼‰
return 301 https://$server_name$request_uri;  # ã‚³ãƒ¡ãƒ³ãƒˆè§£é™¤
```

### SSLè¨¼æ˜æ›¸ã®è‡ªå‹•æ›´æ–°

```bash
# Crontabã«è¿½åŠ ï¼ˆæœˆ2å›æ›´æ–°ãƒã‚§ãƒƒã‚¯ï¼‰
sudo crontab -e

# ä»¥ä¸‹ã‚’è¿½åŠ :
0 12 * * 0 certbot renew --quiet && systemctl reload nginx
```

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. "Welcome to nginx" ãŒè¡¨ç¤ºã•ã‚Œã‚‹

**åŸå› **: Nginxè¨­å®šãŒé©ç”¨ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```bash
make nginx-setup
make service-restart
```

#### 2. Server Error (500)

**åŸå› **: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

**è§£æ±ºæ–¹æ³•**:
```bash
# ãƒ­ã‚°ã®ç¢ºèª
make service-logs
sudo tail -50 /var/log/kokkosofter/gunicorn_error.log

# ä¸€èˆ¬çš„ãªè§£æ±ºæ–¹æ³•
make fix-permissions
make migrate
make static
make service-restart
```

#### 3. PR_END_OF_FILE_ERROR

**åŸå› **: SSL/TLSè¨­å®šã¾ãŸã¯ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã®å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
make service-status
make nginx-status

# ãƒ­ã‚°ç¢ºèª
make service-logs
sudo journalctl -u nginx -f
```

#### 4. DisallowedHost ã‚¨ãƒ©ãƒ¼

**åŸå› **: ALLOWED_HOSTSã«ã‚¢ã‚¯ã‚»ã‚¹å…ƒãŒå«ã¾ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```bash
# å¯¾è©±å¼ã§è¨­å®š
make configure-domain

# ã¾ãŸã¯æ‰‹å‹•ã§.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
nano /var/www/kokkosofter/.env
# ALLOWED_HOSTSã«IPã‚¢ãƒ‰ãƒ¬ã‚¹/ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¿½åŠ 

# ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
make service-restart
```

#### 5. æ¨©é™ã‚¨ãƒ©ãƒ¼ï¼ˆOperationalError: attempt to write a readonly databaseï¼‰

**åŸå› **: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ä¿®æ­£
sudo chown www-data:www-data /var/www/kokkosofter/db.sqlite3
sudo chmod 664 /var/www/kokkosofter/db.sqlite3

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®æ¨©é™ä¿®æ­£
make fix-permissions
make service-restart
```

#### 6. ã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•ã—ãªã„

**åŸå› **: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‘ã‚¹ã®å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# è©³ç´°ãƒ­ã‚°ç¢ºèª
sudo journalctl -xeu kokkosofter.service

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
make debug-gunicorn

# è¨­å®šãƒã‚§ãƒƒã‚¯
make test-django
```

#### 7. ç®¡ç†ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

**åŸå› **: ã‚¹ã‚¿ãƒƒãƒ•æ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```bash
# ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ
make superuser

# ã¾ãŸã¯æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¹ã‚¿ãƒƒãƒ•æ¨©é™ã‚’ä»˜ä¸
# Djangoç®¡ç†ç”»é¢ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†
```

#### 8. æŠ•ç¨¿å‰Šé™¤ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: æ¨©é™ä¸è¶³ã¾ãŸã¯æŠ•ç¨¿ä½œæˆè€…ä¸ä¸€è‡´

**ç¢ºèªæ–¹æ³•**:
- è‡ªåˆ†ã®æŠ•ç¨¿ã‹ã©ã†ã‹ç¢ºèª
- ç®¡ç†è€…æ¨©é™ãŒã‚ã‚‹ã‹ã©ã†ã‹ç¢ºèª
- JavaScript ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç¢ºèª

#### 9. Ajaxå‰Šé™¤ãŒå¤±æ•—ã™ã‚‹

**åŸå› **: CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã¾ãŸã¯æ¨©é™ã®å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# CSRFè¨­å®šç¢ºèª
make check-csrf

# ãƒ–ãƒ©ã‚¦ã‚¶ã§CSRFãƒˆãƒ¼ã‚¯ãƒ³ãŒæ­£ã—ãé€ä¿¡ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
# é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ« > Network ã‚¿ãƒ–ã§ç¢ºèª
```

#### 10. ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ã¾ãŸã¯Nginxè¨­å®šã®å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿®æ­£
make fix-media

# ãƒ¡ãƒ‡ã‚£ã‚¢è¨­å®šç¢ºèª
make check-media

# Nginxè¨­å®šç¢ºèª
sudo nginx -t
```

#### 11. Gitæ›´æ–°æ™‚ã®ãƒãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼

**åŸå› **: ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã¨ãƒªãƒ¢ãƒ¼ãƒˆå¤‰æ›´ã®ç«¶åˆ

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
```
error: Your local changes would be overwritten by merge
Please commit your changes or stash them before you merge.
```

**è§£æ±ºæ–¹æ³•**:
```bash
# ç¾åœ¨ã®å¤‰æ›´çŠ¶æ³ã‚’ç¢ºèª
git status

# æ–¹æ³•1: å¤‰æ›´ã‚’ä¸€æ™‚ä¿å­˜ï¼ˆæ¨å¥¨ï¼‰
git stash
git pull origin main
git stash pop  # å¿…è¦ã«å¿œã˜ã¦

# æ–¹æ³•2: ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ç ´æ£„ï¼ˆæ³¨æ„ï¼‰
git reset --hard HEAD
git clean -fd
git pull origin main

# æ–¹æ³•3: ã‚³ãƒŸãƒƒãƒˆå¾Œã«ãƒãƒ¼ã‚¸
git add .
git commit -m "Local changes"
git pull origin main

# æ›´æ–°å¾Œã®å‡¦ç†
make migrate
make static
make service-restart
```

#### 12. æœ¬ç•ªç’°å¢ƒã§ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ±ç¢ºèª

**ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã®ç·åˆç¢ºèª**:
```bash
# ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
make service-status
make nginx-status

# è¨­å®šç¢ºèª
make check-csrf
make check-media

# ãƒ­ã‚°ç¢ºèª
make service-logs
sudo tail -50 /var/log/kokkosofter/django.log

# Djangoè¨­å®šãƒã‚§ãƒƒã‚¯
make test-django
```

### ãƒ­ã‚°ã®ç¢ºèªæ–¹æ³•

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
sudo journalctl -u kokkosofter -f

# Nginxãƒ­ã‚°
sudo journalctl -u nginx -f
sudo tail -f /var/log/nginx/error.log

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ãƒ­ã‚°
sudo tail -f /var/log/kokkosofter/django.log
sudo tail -f /var/log/kokkosofter/gunicorn_error.log
```

## ğŸ”„ æ›´æ–°ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›´æ–°

```bash
# æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
cd /var/www/kokkosofter
git pull origin main

# ä¾å­˜é–¢ä¿‚ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ›´æ–°
make migrate
make static

# ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
make service-restart
```

### âš ï¸ Gitãƒãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹:**
```
error: Your local changes to the following files would be overwritten by merge:
        Makefile
        README.md
        accounts/forms.py
        ...
Please commit your changes or stash them before you merge.
```

**è§£æ±ºæ–¹æ³•ï¼ˆ3ã¤ã®é¸æŠè‚¢ï¼‰:**

#### æ–¹æ³•1: ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ä¸€æ™‚ä¿å­˜ï¼ˆæ¨å¥¨ï¼‰
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’stashã«ä¿å­˜
git stash

# æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
git pull origin main

# å¿…è¦ã«å¿œã˜ã¦stashã®å†…å®¹ã‚’ç¢ºèªãƒ»é©ç”¨
git stash list
git stash pop  # æœ€æ–°ã®stashã‚’é©ç”¨ï¼ˆç«¶åˆãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ï¼‰

# ä¾å­˜é–¢ä¿‚ã¨ã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°
make migrate
make static
make service-restart
```

#### æ–¹æ³•2: ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ç ´æ£„ï¼ˆæ³¨æ„ãŒå¿…è¦ï¼‰
```bash
# âš ï¸ è­¦å‘Š: ãƒ­ãƒ¼ã‚«ãƒ«ã®å¤‰æ›´ãŒã™ã¹ã¦å‰Šé™¤ã•ã‚Œã¾ã™
git reset --hard HEAD
git clean -fd

# æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
git pull origin main

# ä¾å­˜é–¢ä¿‚ã¨ã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°
make migrate
make static
make service-restart
```

#### æ–¹æ³•3: ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆå¾Œã«ãƒãƒ¼ã‚¸
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
git add .
git commit -m "Local changes before update"

# æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ï¼ˆãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹ï¼‰
git pull origin main

# ç«¶åˆãŒç™ºç”Ÿã—ãŸå ´åˆã¯æ‰‹å‹•ã§è§£æ±º
# ä¾å­˜é–¢ä¿‚ã¨ã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°
make migrate
make static
make service-restart
```

### ğŸ”§ å®‰å…¨ãªæ›´æ–°æ‰‹é †ï¼ˆæ¨å¥¨ï¼‰

æœ¬ç•ªç’°å¢ƒã§ã®å®‰å…¨ãªæ›´æ–°æ‰‹é †ï¼š

```bash
# 1. ç¾åœ¨ã®çŠ¶æ…‹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
make backup-db
sudo cp -r /var/www/kokkosofter /backup/kokkosofter_$(date +%Y%m%d_%H%M%S)

# 2. ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
make service-status

# 3. ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ç¢ºèª
cd /var/www/kokkosofter
git status

# 4. ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ãŒã‚ã‚‹å ´åˆã¯stash
git stash

# 5. æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
git pull origin main

# 6. ä¾å­˜é–¢ä¿‚ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°
make migrate
make static

# 7. æ¨©é™ä¿®æ­£
make fix-permissions

# 8. ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
make service-restart

# 9. å‹•ä½œç¢ºèª
make service-status
make service-logs

# 10. å¿…è¦ã«å¿œã˜ã¦stashã®å†…å®¹ã‚’ç¢ºèª
git stash list
```

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
make backup-db

# ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
sudo tar -czf /backup/kokkosofter_$(date +%Y%m%d).tar.gz /var/www/kokkosofter
```

## ğŸ’» é–‹ç™ºç’°å¢ƒ

é–‹ç™ºç”¨ã®ç°¡æ˜“ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼š

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/hatane-rgb/KokkoSofter.git
cd KokkoSofter

# é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆSECRET_KEYè‡ªå‹•ç”Ÿæˆï¼‰
make dev-setup

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
make run
```

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
/var/www/kokkosofter/        # æœ¬ç•ªç’°å¢ƒãƒ‘ã‚¹
â”œâ”€â”€ KokkoSofter/             # Djangoè¨­å®š
â”œâ”€â”€ accounts/                # èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ views.py            # ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
â”‚   â”œâ”€â”€ forms.py            # ç®¡ç†è€…ç”¨ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â””â”€â”€ urls.py             # ç®¡ç†è€…ç”¨URL
â”œâ”€â”€ core/                    # ã‚³ã‚¢æ©Ÿèƒ½
â”œâ”€â”€ posts/                   # æŠ•ç¨¿æ©Ÿèƒ½
â”‚   â”œâ”€â”€ views.py            # æŠ•ç¨¿å‰Šé™¤ãƒ»ç®¡ç†æ©Ÿèƒ½
â”‚   â””â”€â”€ urls.py             # æŠ•ç¨¿ç®¡ç†URL
â”œâ”€â”€ templates/               # HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ base.html           # ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆç®¡ç†è€…ãƒ¡ãƒ‹ãƒ¥ãƒ¼å«ã‚€ï¼‰
â”‚   â”œâ”€â”€ home.html           # ãƒ›ãƒ¼ãƒ ç”»é¢ï¼ˆæŠ•ç¨¿å‰Šé™¤æ©Ÿèƒ½å«ã‚€ï¼‰
â”‚   â”œâ”€â”€ accounts/           # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–¢é€£ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ admin_dashboard.html    # ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ admin_users.html        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢
â”‚   â”‚   â”œâ”€â”€ admin_create_user.html  # ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆç”»é¢
â”‚   â”‚   â””â”€â”€ admin_edit_user.html    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†ç”»é¢
â”‚   â””â”€â”€ posts/              # æŠ•ç¨¿é–¢é€£ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚       â””â”€â”€ admin_posts.html        # æŠ•ç¨¿ç®¡ç†ç”»é¢
â”œâ”€â”€ static/                  # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ media/                   # ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ venv/                    # Pythonä»®æƒ³ç’°å¢ƒ
â”œâ”€â”€ .env                     # ç’°å¢ƒè¨­å®šï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”œâ”€â”€ deploy.sh               # ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ Makefile               # é‹ç”¨ã‚³ãƒãƒ³ãƒ‰
â”œâ”€â”€ gunicorn_config.py     # Gunicornè¨­å®š
â”œâ”€â”€ nginx_kokkosofter.conf # Nginxè¨­å®š
â””â”€â”€ kokkosofter.service    # systemdã‚µãƒ¼ãƒ“ã‚¹
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½

- âœ… **SECRET_KEYè‡ªå‹•ç”Ÿæˆ**: ã‚»ã‚­ãƒ¥ã‚¢ãªãƒ©ãƒ³ãƒ€ãƒ ã‚­ãƒ¼
- âœ… **CSRFä¿è­·**: ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªå¯¾ç­–
- âœ… **XSSä¿è­·**: ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°å¯¾ç­–  
- âœ… **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**: NginxçµŒç”±ã§é©ç”¨
- âœ… **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰åˆ¶é™**: ã‚µã‚¤ã‚ºã¨ç¨®é¡ã®åˆ¶é™
- âœ… **HTTPSå¯¾å¿œ**: SSLè¨¼æ˜æ›¸è¨­å®šï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆæ¸ˆã¿ï¼‰
- âœ… **HSTSå¯¾å¿œ**: HTTP Strict Transport Security
- âœ… **ç’°å¢ƒåˆ¥ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š**: é–‹ç™ºãƒ»æœ¬ç•ªç’°å¢ƒã®è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
- âœ… **æ¨©é™ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**: `@staff_member_required`ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿
- âœ… **æŠ•ç¨¿å‰Šé™¤æ¨©é™åˆ¶å¾¡**: ä½œæˆè€…ãƒ»ç®¡ç†è€…ã®ã¿å‰Šé™¤å¯èƒ½
- âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ¨©é™**: ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¹ã‚¿ãƒƒãƒ•æ¨©é™å¤‰æ›´å¯èƒ½
- âœ… **Ajax CSRFä¿è­·**: éåŒæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- âœ… **å®‰å…¨ãªå‰Šé™¤ç¢ºèª**: ãƒ¢ãƒ¼ãƒ€ãƒ«ç¢ºèªãƒ»äºŒé‡å‰Šé™¤é˜²æ­¢

## ğŸ›¡ï¸ æ¨©é™ã‚·ã‚¹ãƒ†ãƒ 

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¨®åˆ¥
1. **ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼** (`is_active=True, is_staff=False`)
   - æŠ•ç¨¿ä½œæˆãƒ»ã„ã„ã­
   - è‡ªåˆ†ã®æŠ•ç¨¿å‰Šé™¤ã®ã¿
   - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†

2. **ã‚¹ã‚¿ãƒƒãƒ•ãƒ¦ãƒ¼ã‚¶ãƒ¼** (`is_staff=True`)
   - ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹
   - å…¨æŠ•ç¨¿ã®å‰Šé™¤ãƒ»ç®¡ç†
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ»ç·¨é›†
   - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹åˆ‡ã‚Šæ›¿ãˆ

3. **ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼** (`is_superuser=True`)
   - Djangoç®¡ç†ç”»é¢ãƒ•ãƒ«ã‚¢ã‚¯ã‚»ã‚¹
   - ã‚¹ã‚¿ãƒƒãƒ•æ¨©é™ã®ä»˜ä¸ãƒ»å‰Šé™¤
   - ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ç®¡ç†

### å®‰å…¨æ€§å¯¾ç­–
- **è‡ªå·±å‰Šé™¤é˜²æ­¢**: è‡ªåˆ†è‡ªèº«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ä¸å¯
- **ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿è­·**: ä¸€èˆ¬ã‚¹ã‚¿ãƒƒãƒ•ã«ã‚ˆã‚‹å¤‰æ›´ä¸å¯
- **æ®µéšçš„æ¨©é™**: å¿…è¦æœ€å°é™ã®æ¨©é™ä»˜ä¸
- **ç›£æŸ»ãƒ­ã‚°**: Djangoç®¡ç†ç”»é¢ã§ã®å¤‰æ›´å±¥æ­´

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆï¼š

1. **ãƒ­ã‚°ç¢ºèª**: `make service-logs`
2. **ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹**: `make service-status`
3. **Issueä½œæˆ**: [GitHub Issues](https://github.com/hatane-rgb/KokkoSofter/issues)

## ğŸš¨ ç·Šæ€¥æ™‚ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### æœ¬ç•ªç’°å¢ƒã§å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã®å¯¾å‡¦é †åº

#### 1. åŸºæœ¬ç¢ºèª
```bash
make service-status     # ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
make service-logs       # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
make nginx-status       # NginxçŠ¶æ…‹ç¢ºèª
```

#### 2. Gitæ›´æ–°ã‚¨ãƒ©ãƒ¼ã®å ´åˆ
```bash
cd /var/www/kokkosofter
git status              # å¤‰æ›´çŠ¶æ³ç¢ºèª
git stash               # ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ä¿å­˜
git pull origin main    # æœ€æ–°ã‚³ãƒ¼ãƒ‰å–å¾—
make migrate && make static && make service-restart
```

#### 3. æ¨©é™ã‚¨ãƒ©ãƒ¼ã®å ´åˆ
```bash
make fix-permissions    # ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿®æ­£
make fix-media          # ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿®æ­£
make service-restart    # ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
```

#### 4. ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ã‚¨ãƒ©ãƒ¼ã®å ´åˆ
```bash
make debug-gunicorn     # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ãƒ†ã‚¹ãƒˆ
make test-django        # Djangoè¨­å®šãƒã‚§ãƒƒã‚¯
make fix-permissions && make service-restart
```

#### 5. ç·Šæ€¥æ™‚ã®å®Œå…¨ãƒªã‚»ãƒƒãƒˆ
```bash
# âš ï¸ æœ€çµ‚æ‰‹æ®µï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ãŒå¤±ã‚ã‚Œã¾ã™ï¼‰
git reset --hard HEAD && git clean -fd
git pull origin main
make fix-permissions && make fix-media
make migrate && make static
make nginx-setup && make service-restart
```

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§ã™ã€‚

---

**ğŸ¯ æœ¬ç•ªé‹ç”¨ã‚’é‡è¦–ã—ãŸè¨­è¨ˆ**  
**Made with â¤ï¸ by KokkoSoft Team**
